Сбрасывание PRIMARY. Смена первичного узла и переназначение приоритетов

rs.stepDown(60,40)

60 секунд — время, в течение которого сервер, с которого запущено выполнение команды, не может стать Primary; 40 секунд — время перевыборов нового Primary.

db.adminCommand({replSetStepDown: 30, force: 1})

30 секунд — время отключения Primary и перевыборы. Выполнение команды допустимо с любого из серверов mongoDB.


rs.stepDown(60)

Узел, с которого запущена команда, в течение 60 секунд не сможет стать Primary.

/var/lib/mongodb/ — Тут лежат файлы баз.

Восстановление из дампа:
Восстанавление базы в каталог по умолчанию. Если файл в с таким именем есть, то он перезаписывается:

mongorestore <Имя БД>


Восстановление всех баз из указанного каталога:

mongorestore ./Backup


Восстановление отдельной таблицы(коллекции):

mongorestore --collection <коллекция> --db <Имя БД> dump/


Создание дампа
создание бэкапа всех баз в папку Backup:

mongodump --out /Backup

создание бэкапа отдельной базы:

mongodump  --db <Имя БД> --out /Backup

создание бэкапа отдельной таблицы:

mongodump  --db <Имя БД> --collection <Имя коллекции>--out /Backup

Запуск от имени root, создание бэкапа указанной базы в указанный каталог + текущая дата:

sudo mongodump --db newdb --out /var/backups/mongobackups/'date +"%m-%d-%y"'